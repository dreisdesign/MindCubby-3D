; Ender 3 V2 - Optimized Start G-code (active)
; Purpose: Improve first-layer adhesion by applying a lower initial Z for priming/skirt
; Date: 2025-11-16
; Notes: Active start G-code used by repository

M140 S{material_bed_temperature} ; Set bed temp (non-blocking)
M104 S{material_print_temperature} ; Set nozzle temp (non-blocking)
M190 S{material_bed_temperature} ; Wait for bed
M109 S{material_print_temperature} ; Wait for nozzle

G92 E0 ; Reset extruder
G28 ; Home all axes
M82 ; Set extruder to absolute mode (and keep it there)
G90 ; Ensure absolute positioning for XYZ moves
M501 ; Load settings from EEPROM
M420 S1 ; Enable mesh from EEPROM
G29 ; Re-probe with BLTouch

G1 Z2.0 F3000 ; Lift Z a little
; --- Off-print purge + wipe to avoid dragging a blob onto the model ---
G1 X10 Y200 F5000.0 ; Move to purge corner
G1 Z0.2 F1200.0 ; Lower to first layer height for priming
; --- AGGRESSIVE PRIME LINE ---
G1 X150 Y200 Z0.2 F1500.0 E15 ; Draw a long, heavy prime line
G1 X150 Y205 Z0.2 F1500.0 E30 ; Draw a second, heavier line right next to it
G92 E0 ; Reset extruder to 0 after priming is done
G1 Z2.0 F3000 ; Lift Z to clear the prime line
G1 X30 Y20 Z2.0 F5000.0 ; Move to print start area

; NOTE: Cura will now take over. It may issue a small retraction, but the first layer
; will start from a known E0 position with a fully primed nozzle.
; Required Cura Settings:
; - Retraction: ON (e.g., 5mm)
; - Skirt Line Count: 0